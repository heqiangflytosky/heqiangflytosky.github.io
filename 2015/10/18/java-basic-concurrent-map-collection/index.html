<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="并发集合," />





  <link rel="alternate" href="/atom.xml" title="孤舟蓑笠翁，独钓寒江雪" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0" />






<meta name="description" content="并发包中的集合的使用">
<meta property="og:type" content="article">
<meta property="og:title" content="Java 基础 -- 并发集合的使用">
<meta property="og:url" content="http://yoursite.com/2015/10/18/java-basic-concurrent-map-collection/index.html">
<meta property="og:site_name" content="孤舟蓑笠翁，独钓寒江雪">
<meta property="og:description" content="并发包中的集合的使用">
<meta property="og:image" content="http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuGh9BCb9LL3oIYnBL7YwSzlJ_ec-YGKlPxSzdT3nR67RitdRdixUfyJ5bPbNabgKbfYSgW2KHk85vnULfAQWYlabbcMc9oRbfA8AE-Vd9PSM5QNcbU0IHz6Oc5HSKfIONAAGd9DONApW2EM2f20Y27qUYSKPsCI3ipCBV3ABmNf004WhsDJewI4R1XO4YkhgeZaGIGr46jC-50qA4ACnLI4iG0GMd0MHGF4uWeDfCuf2X31-bPX-mH56s7KZ_8Mfmo4rBmMOYW00">
<meta property="og:image" content="http://www.plantuml.com/plantuml/svg/XLJBgjim4DtxAyJTt_i5NIHDLYNqWGDTAyua5L6aL9O3Xgv3TstNWK9_8j1D_yQ1_iN5FfXed37P6C-SCsSU6cbIHXrYjRVPqaHBwkcTFchL_BqqFtxDlBLKHEFT__Ef-Vdz-kTq_Nrfpl-UiiouI66Z2r8tLkBCAQQM3v7MtFTU7yrMhonnzyAKgVcfeeeI-wtrnSwuxT0_fwyYR-XV1ktA3GN4wrKPWowYAgmkIpM56PEEHXWvnJ48ol3Dl2kg4CZ5V6SERMjjO8yTwW_kSp2HfY7ekaL7e5jGP_QzoPaMnkreZRw1pSdgEYM3maSa8VSnV7n0yjeLNu9tlYfJzyTWV31nK6rscwrwy-tbHPWvfpm_TxkKK-Jytjaoalt2Nm_m9RjFfS1ADPD_WF8Pfi8eJEODUi5wjny42Kl0Iq3Ka2OfOxxT5mu-U010SEBTbrC1i429C3f8VWcG4uroW6S0Gzfj5eKK0WsTG4Mu1sB149FPFAlC73Oe4yG6akl8se0Eq95WyUOo2o8IxQ7QM4cFQL3ZRyDeEavZbahpFPJZxuvSEkV8PokzLBAQJ9oGMrTx-me0">
<meta property="og:updated_time" content="2018-11-21T09:58:18.407Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Java 基础 -- 并发集合的使用">
<meta name="twitter:description" content="并发包中的集合的使用">
<meta name="twitter:image" content="http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuGh9BCb9LL3oIYnBL7YwSzlJ_ec-YGKlPxSzdT3nR67RitdRdixUfyJ5bPbNabgKbfYSgW2KHk85vnULfAQWYlabbcMc9oRbfA8AE-Vd9PSM5QNcbU0IHz6Oc5HSKfIONAAGd9DONApW2EM2f20Y27qUYSKPsCI3ipCBV3ABmNf004WhsDJewI4R1XO4YkhgeZaGIGr46jC-50qA4ACnLI4iG0GMd0MHGF4uWeDfCuf2X31-bPX-mH56s7KZ_8Mfmo4rBmMOYW00">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '6377131610457769000',
      author: '寒江蓑笠'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2015/10/18/java-basic-concurrent-map-collection/"/>





  <title> Java 基础 -- 并发集合的使用 | 孤舟蓑笠翁，独钓寒江雪 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  








  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1261134288&web_id=1261134288" language="JavaScript"></script>
  </div>





  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">孤舟蓑笠翁，独钓寒江雪</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">程序猿的世界</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-links">
          <a href="/links" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-users"></i> <br />
            
            友情链接
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/10/18/java-basic-concurrent-map-collection/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="寒江蓑笠">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/icon.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="孤舟蓑笠翁，独钓寒江雪">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="孤舟蓑笠翁，独钓寒江雪" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Java 基础 -- 并发集合的使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-18T10:00:00+08:00">
                2015-10-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a class="cloud-tie-join-count" href="/2015/10/18/java-basic-concurrent-map-collection/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count join-count" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/10/18/java-basic-concurrent-map-collection/" class="leancloud_visitors" data-flag-title="Java 基础 -- 并发集合的使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
              <div class="post-description">
                  并发包中的集合的使用
              </div>
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>前面大多数集合并不适合用在并发应用程序中，因为它们没有控制并发访问数据。如果一些并发任务共享一个数据结构，而这个数据结构并不适合用在并发任务中，你将会有数据不一致的错误，这将影响到程序的正确运行。比如 ArrayList 类。<br>为了方便开发者并发编程，在 JDK 5.0 中加入了并发包 java.util.concurrent.*，它提供了可以在并发程序中使用的类，本文仅介绍并发结合的特点和使用方法。</p>
<p><img src="http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuGh9BCb9LL3oIYnBL7YwSzlJ_ec-YGKlPxSzdT3nR67RitdRdixUfyJ5bPbNabgKbfYSgW2KHk85vnULfAQWYlabbcMc9oRbfA8AE-Vd9PSM5QNcbU0IHz6Oc5HSKfIONAAGd9DONApW2EM2f20Y27qUYSKPsCI3ipCBV3ABmNf004WhsDJewI4R1XO4YkhgeZaGIGr46jC-50qA4ACnLI4iG0GMd0MHGF4uWeDfCuf2X31-bPX-mH56s7KZ_8Mfmo4rBmMOYW00" alt="效果图"></p>
<p><img src="http://www.plantuml.com/plantuml/svg/XLJBgjim4DtxAyJTt_i5NIHDLYNqWGDTAyua5L6aL9O3Xgv3TstNWK9_8j1D_yQ1_iN5FfXed37P6C-SCsSU6cbIHXrYjRVPqaHBwkcTFchL_BqqFtxDlBLKHEFT__Ef-Vdz-kTq_Nrfpl-UiiouI66Z2r8tLkBCAQQM3v7MtFTU7yrMhonnzyAKgVcfeeeI-wtrnSwuxT0_fwyYR-XV1ktA3GN4wrKPWowYAgmkIpM56PEEHXWvnJ48ol3Dl2kg4CZ5V6SERMjjO8yTwW_kSp2HfY7ekaL7e5jGP_QzoPaMnkreZRw1pSdgEYM3maSa8VSnV7n0yjeLNu9tlYfJzyTWV31nK6rscwrwy-tbHPWvfpm_TxkKK-Jytjaoalt2Nm_m9RjFfS1ADPD_WF8Pfi8eJEODUi5wjny42Kl0Iq3Ka2OfOxxT5mu-U010SEBTbrC1i429C3f8VWcG4uroW6S0Gzfj5eKK0WsTG4Mu1sB149FPFAlC73Oe4yG6akl8se0Eq95WyUOo2o8IxQ7QM4cFQL3ZRyDeEavZbahpFPJZxuvSEkV8PokzLBAQJ9oGMrTx-me0" alt="效果图"></p>
<h2 id="并发-Map-框架"><a href="#并发-Map-框架" class="headerlink" title="并发 Map 框架"></a>并发 Map 框架</h2><h3 id="ConcurrentHashMap"><a href="#ConcurrentHashMap" class="headerlink" title="ConcurrentHashMap"></a>ConcurrentHashMap</h3><p>ConcurrentHashMap 是线程安全且高效的 HashMap，底层采用分段的数组+链表实现，线程安全ConcurrentHashMap允许多个修改操作并发进行，其关键在于使用了锁分离技术。它使用了多个锁来控制对hash表的不同部分进行的修改。ConcurrentHashMap内部使用段(Segment)来表示这些不同的部分，每个段其实就是一个小的Hashtable，它们有自己的锁。只要多个修改操作发生在不同的段上，它们就可以并发进行。</p>
<p>JDK1.8的实现已经摒弃了Segment的概念，而是直接用Node数组+链表+红黑树的数据结构来实现，此时锁加在key上，并发控制使用Synchronized和CAS来操作，整个看起来就像是优化过且线程安全的HashMap，虽然在JDK1.8中还能看到Segment的数据结构，但是已经简化了属性，只是为了兼容旧版本。</p>
<h3 id="ConcurrentSkipListMap"><a href="#ConcurrentSkipListMap" class="headerlink" title="ConcurrentSkipListMap"></a>ConcurrentSkipListMap</h3><p><code>ConcurrentSkipListMap</code> 的 key 是有序的，底层是通过跳表来实现的。</p>
<h2 id="并发-Collection-框架"><a href="#并发-Collection-框架" class="headerlink" title="并发 Collection 框架"></a>并发 Collection 框架</h2><h3 id="BlockingQueue"><a href="#BlockingQueue" class="headerlink" title="BlockingQueue"></a>BlockingQueue</h3><p>BlockingQueue 就是阻塞队列，它是一个先进先出的队列，当获取队列元素但是队列为空时，会阻塞等待队列中有元素再返回。当添加元素时，如果队列已满，那么等到队列可以放入新元素时再放入。<br>BlockingQueue 的实现都是线程安全的。<br>BlockingQueue 通常用于实现生产者-消费者队列的场景，当然，你也可以将它当做普通的 Collection 来用。</p>
<h4 id="ArrayBlockingQueue"><a href="#ArrayBlockingQueue" class="headerlink" title="ArrayBlockingQueue"></a>ArrayBlockingQueue</h4><p>数组阻塞队列，它实现了 BlockingQueue 接口。其内部实现是将对象放到一个数组里。</p>
<h4 id="DelayQueue"><a href="#DelayQueue" class="headerlink" title="DelayQueue"></a>DelayQueue</h4><p>延迟队列，它实现了 BlockingQueue 接口。只有在延迟期满时才能从中提取元素。该队列的头部是延迟期满后保存时间最长的Delayed 元素。</p>
<h4 id="LinkedBlockingQueue"><a href="#LinkedBlockingQueue" class="headerlink" title="LinkedBlockingQueue"></a>LinkedBlockingQueue</h4><p>链阻塞队列，内部以一个链式结构(链接节点)对其元素进行存储。</p>
<h4 id="PriorityBlockingQueue"><a href="#PriorityBlockingQueue" class="headerlink" title="PriorityBlockingQueue"></a>PriorityBlockingQueue</h4><p>具有优先级的阻塞队列，所有插入到 PriorityBlockingQueue 的元素必须实现 java.lang.Comparable 接口。因此该队列中元素的排序就取决于你自己的 Comparable 实现。<br>基于数组，数据结构为二叉堆.</p>
<h4 id="SynchronousQueue"><a href="#SynchronousQueue" class="headerlink" title="SynchronousQueue"></a>SynchronousQueue</h4><p>它的内部同时只能够容纳单个元素。如果该队列已有一元素的话，试图向队列中插入一个新元素的线程将会阻塞，直到另一个线程将该元素从队列中抽走。同样，如果该队列为空，试图向队列中抽取一个元素的线程将会阻塞，直到另一个线程向队列中插入了一条新的元素。</p>
<h4 id="BlockingDeque"><a href="#BlockingDeque" class="headerlink" title="BlockingDeque"></a>BlockingDeque</h4><p>阻塞双端队列，在不能够插入元素时，它将阻塞住试图插入元素的线程；在不能够抽取元素时，它将阻塞住试图抽取的线程。</p>
<h3 id="CopyOnWriteArrayList"><a href="#CopyOnWriteArrayList" class="headerlink" title="CopyOnWriteArrayList"></a>CopyOnWriteArrayList</h3><p><code>CopyOnWriteArrayList</code> 可以说是 <code>ArrayList</code> 的多线程版本，它是线程安全的。<br>它使用了一种叫写时复制的方法，当有新元素添加到 <code>CopyOnWriteArrayList</code> 时，先从原有的数组中拷贝一份出来，然后在新的数组做写操作，写完之后，再将原来的数组引用指向到新数组。</p>
<!-- 
http://www.importnew.com/26461.html
https://www.cnblogs.com/cccw/p/5837448.html
https://blog.csdn.net/king866/article/details/53945400
https://www.cnblogs.com/vijozsoft/p/5585620.html
http://ifeve.com/concurrent-collections-1/
https://blog.csdn.net/ink4t/article/details/76696728
https://www.cnblogs.com/bushi/p/6681543.html
https://www.baidu.com/s?word=CopyOnWriteArrayList&tn=50000021_hao_pg&ie=utf-8&sc=UWd1pgw-pA7EnHc1FMfqnHR1rHb1rj0sPjDknBuW5y99U1Dznzu9m1YknHc3PjTdn6&ssl_sample=s_10%2Cs_77&srcqid=2489131420700060184
https://www.jianshu.com/p/5f570d2f81a2
http://www.runoob.com/java/java-collections.html
http://www.runoob.com/java/java-hashTable-class.html
-->
<!-- 
@startuml
Title "Java 并发Map集合框架图"

interface Map
interface SortedMap
interface NavigableMap
interface ConcurrentMap
interface ConcurrentNavigableMap
abstract class AbstractMap
class ConcurrentHashMap
class ConcurrentSkipListMap




Map <|.. AbstractMap
Map  <|-- ConcurrentMap
AbstractMap <|-- ConcurrentHashMap
ConcurrentMap  <|.. ConcurrentHashMap
Map  <|-- SortedMap
SortedMap <|-- NavigableMap
NavigableMap <|-- ConcurrentNavigableMap
ConcurrentMap <|-- ConcurrentNavigableMap
AbstractMap <|-- ConcurrentSkipListMap
ConcurrentNavigableMap <|.. ConcurrentSkipListMap
@enduml
-->
<!-- 

@startuml
Title "Java 并发Collection集合框架图"

interface Collection
interface Set
interface SortedSet
interface NavigableSet
interface List
interface Queue
interface BlockingQueue
interface Deque
interface BlockingDeque
interface TransferQueue
abstract class AbstractCollection
abstract class AbstractSet
abstract class AbstractQueue
class ConcurrentSkipListSet
class CopyOnWriteArrayList
class CopyOnWriteArraySet
class ArrayBlockingQueue
class ConcurrentLinkedDeque
class DelayQueue
class LinkedBlockingDeque
class LinkedBlockingQueue
class LinkedTransferQueue
class SynchronousQueue
class PriorityBlockingQueue

Collection <|.. AbstractCollection
Collection <|-- Set
Set <|.. AbstractSet
Set <|-- SortedSet
SortedSet <|-- NavigableSet
AbstractCollection  <|-- AbstractSet
AbstractSet <|-- ConcurrentSkipListSet
NavigableSet <|.. ConcurrentSkipListSet
Collection <|-- List
List <|.. CopyOnWriteArrayList
AbstractSet  <|-- CopyOnWriteArraySet
Collection <|-- Queue
Queue <|-- BlockingQueue
Queue  <|-- Deque
Deque <|-- BlockingDeque
BlockingQueue <|-- BlockingDeque
AbstractCollection  <|--  AbstractQueue
Queue <|.. AbstractQueue
BlockingQueue  <|..  ArrayBlockingQueue
AbstractQueue <|--  ArrayBlockingQueue
Deque <|.. ConcurrentLinkedDeque
AbstractCollection <|-- ConcurrentLinkedDeque
AbstractQueue  <|-- ConcurrentLinkedQueue
Queue <|.. ConcurrentLinkedQueue
AbstractQueue <|--  DelayQueue
BlockingQueue <|.. DelayQueue
AbstractQueue <|-- LinkedBlockingDeque
BlockingDeque <|.. LinkedBlockingDeque
AbstractQueue <|-- LinkedBlockingQueue
BlockingQueue <|.. LinkedBlockingQueue
BlockingQueue <|-- TransferQueue
AbstractQueue <|-- LinkedTransferQueue
TransferQueue  <|.. LinkedTransferQueue
AbstractQueue <|-- SynchronousQueue
BlockingQueue <|.. SynchronousQueue
AbstractQueue  <|-- PriorityBlockingQueue
BlockingQueue <|.. PriorityBlockingQueue
@enduml
-->
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/并发集合/" rel="tag"># 并发集合</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/10/10/android-thread-handlerthread-source-code/" rel="next" title="Android 线程 -- HandlerThread 使用及源码分析">
                <i class="fa fa-chevron-left"></i> Android 线程 -- HandlerThread 使用及源码分析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/11/02/android-knowledge-event-transfer-process/" rel="prev" title="Android View 事件处理流程">
                Android View 事件处理流程 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/icon.png"
               alt="寒江蓑笠" />
          <p class="site-author-name" itemprop="name">寒江蓑笠</p>
          <p class="site-description motion-element" itemprop="description">技术博客</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">247</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">35</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">116</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/heqiangflytosky/" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.csdn.net/heqiangflytosky/" target="_blank" title="CSDN">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  CSDN
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#并发-Map-框架"><span class="nav-number">2.</span> <span class="nav-text">并发 Map 框架</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ConcurrentHashMap"><span class="nav-number">2.1.</span> <span class="nav-text">ConcurrentHashMap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ConcurrentSkipListMap"><span class="nav-number">2.2.</span> <span class="nav-text">ConcurrentSkipListMap</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#并发-Collection-框架"><span class="nav-number">3.</span> <span class="nav-text">并发 Collection 框架</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#BlockingQueue"><span class="nav-number">3.1.</span> <span class="nav-text">BlockingQueue</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ArrayBlockingQueue"><span class="nav-number">3.1.1.</span> <span class="nav-text">ArrayBlockingQueue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DelayQueue"><span class="nav-number">3.1.2.</span> <span class="nav-text">DelayQueue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LinkedBlockingQueue"><span class="nav-number">3.1.3.</span> <span class="nav-text">LinkedBlockingQueue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PriorityBlockingQueue"><span class="nav-number">3.1.4.</span> <span class="nav-text">PriorityBlockingQueue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SynchronousQueue"><span class="nav-number">3.1.5.</span> <span class="nav-text">SynchronousQueue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BlockingDeque"><span class="nav-number">3.1.6.</span> <span class="nav-text">BlockingDeque</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CopyOnWriteArrayList"><span class="nav-number">3.2.</span> <span class="nav-text">CopyOnWriteArrayList</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">寒江蓑笠</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "d2475abece3649debc94c21b166fc009",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  






  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("6zbrLyUbhXLbd7RqUSMnxhg4-gzGzoHsz", "fb9g4GyEWQysqnpY9t5CPhpU");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


</body>
</html>
